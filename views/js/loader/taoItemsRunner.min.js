function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("taoItems/assets/manager",["lodash","util/url"],function(_,urlUtil){'use strict';_=_&&Object.prototype.hasOwnProperty.call(_,"default")?_["default"]:_,urlUtil=urlUtil&&Object.prototype.hasOwnProperty.call(urlUtil,"default")?urlUtil["default"]:urlUtil;var checkStrategy=function(strategy){if(!_.isPlainObject(strategy)||!_.isFunction(strategy.handle)||!_.isString(strategy.name))throw new TypeError("An asset resolution strategy is an object with a handle method and a name")},assetManagerFactory=function(strategies,data,options){var assetManager,cache={};return strategies=_.isArray(strategies)?strategies:[strategies],data=data||{},options=_.defaults(options||{},{parseUrl:!0}),assetManager={_strategies:[],addStrategy:function(strategy){checkStrategy(strategy),this._strategies.push(strategy)},prependStrategy:function(strategy){checkStrategy(strategy),this._strategies.unshift(strategy)},setStrategies:function(newStrategies){var self=this;this._strategies=[],_.forEach(newStrategies,function(strategy){_.isPlainObject(strategy)?assetManager.addStrategy(strategy):_.isFunction(strategy)&&self.addStrategy({name:"strategy_"+(self._strategies.length+1),handle:strategy})})},setData:function(key,value){_.isString(key)&&"undefined"!=typeof value?data[key]=value:_.isPlainObject(key)&&(data=key)},getData:function(key){return _.isString(key)?data[key]:data},resolve:function(url){var resolved,inputUrl;return options.cache&&cache.hasOwnProperty(url)?cache[url]:(inputUrl=options.parseUrl?urlUtil.parse(url):url,_.forEach(this._strategies,function(strategy){var result=strategy.handle(inputUrl,data);if(result)return resolved=result,!1}),resolved=resolved||"",options.cache&&(cache[url]=resolved),resolved)},resolveBy:function(name,url){var inputUrl,resolved="",strategy=_.find(this._strategies,{name:name});return strategy&&(inputUrl=options.parseUrl?urlUtil.parse(url):url,resolved=strategy.handle(inputUrl,data)),resolved},clearCache:function(){options.cache&&(cache={})}},assetManager.setStrategies(strategies),assetManager};return assetManagerFactory}),define("taoItems/assets/strategies",["util/url","lodash"],function(urlUtil,_){'use strict';urlUtil=urlUtil&&Object.prototype.hasOwnProperty.call(urlUtil,"default")?urlUtil["default"]:urlUtil,_=_&&Object.prototype.hasOwnProperty.call(_,"default")?_["default"]:_;var prependToUrl=function(url,base,slashcat){return!0===slashcat?base.replace(/\/$/,"")+"/"+url.directory.replace(/^\.\//,"").replace(/^\//,"")+encodeURIComponent(url.file.replace(/^\.\//,"").replace(/^\//,"")):base+url.directory.replace(/^\.?\//,"")+encodeURIComponent(url.file.replace(/^\.?\//,""))};return{packedUrl:{name:"packedUrl",handle:function(url,data){var type;if(!_.isUndefined(url.source)&&!_.isUndefined(data.assets)&&(type=_.findKey(data.assets,url.source),type&&urlUtil.isAbsolute(data.assets[type][url.source])))return data.assets[type][url.source]}},baseUrl:{name:"baseUrl",handle:function(url,data){if("string"==typeof data.baseUrl&&urlUtil.isRelative(url))return prependToUrl(url,data.baseUrl,data.slashcat)}},itemCssNoCache:{name:"itemCssNoCache",handle:function(url,data){if("string"==typeof data.baseUrl&&urlUtil.isRelative(url)&&/\.css$/.test(url.file))return urlUtil.build(prependToUrl(url,data.baseUrl,data.slashcat),{bust:Date.now()})}},external:{name:"external",handle:function(url){if(urlUtil.isAbsolute(url))return url.toString()}},base64:{name:"base64",handle:function(url){if(urlUtil.isBase64(url))return url.toString()}},taomedia:{name:"taomedia",handle:function(url,data){var baseUrl=data.baseUrl||"./";if("object"===_typeof(url)&&"taomedia"===url.protocol||/^taomedia:\/\//.test(url.toString()))return baseUrl+url.toString()}}}}),define("taoItems/runner/api/itemRunner",["jquery","core/eventifier","taoItems/assets/manager"],function($,eventifier,assetManagerFactory){'use strict';$=$&&Object.prototype.hasOwnProperty.call($,"default")?$["default"]:$,eventifier=eventifier&&Object.prototype.hasOwnProperty.call(eventifier,"default")?eventifier["default"]:eventifier,assetManagerFactory=assetManagerFactory&&Object.prototype.hasOwnProperty.call(assetManagerFactory,"default")?assetManagerFactory["default"]:assetManagerFactory;var itemRunnerFactory=function itemRunnerFactory(providerName){var data=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},options=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},flow={init:{done:!1,pending:[]},render:{done:!1,pending:[]}};"object"===_typeof(providerName)&&(data=providerName,providerName=void 0);var providers=itemRunnerFactory.providers;if(!providers||0===Object.keys(providers).length)throw new Error("No provider registered");var provider;if("string"==typeof providerName&&0<providerName.length?provider=providers[providerName]:1===Object.keys(providers).length&&(providerName=Object.keys(providers)[0],provider=providers[providerName]),!provider)throw new Error("No candidate found for the provider");var assetManager=options.assetManager||assetManagerFactory(function(url){return url.toString()}),suspended=!1,closed=!1;return eventifier({container:null,assetManager:assetManager,options:options,init:function init(newData){var _this=this,initDone=function(){!1===flow.init.done&&(flow.init.done=!0,flow.init.pending.filter(function(pendingTask){return"function"==typeof pendingTask}).forEach(function(pendingTask){return pendingTask()}),flow.init.pending=[]),_this.trigger("init")};return newData&&(data=Object.assign(data,newData)),"function"==typeof provider.init?provider.init.call(this,data,initDone):initDone(),this},assets:function assets(strategies,contextData,assetManagerOptions){try{this.assetManager=assetManagerFactory(strategies,contextData,assetManagerOptions)}catch(err){this.trigger("error",new Error("Something was wrong while configuring the asset manager : ".concat(err.message)))}return this},render:function render(elt){var _this2=this,newOptions=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},renderDone=function(){!1===flow.render.done&&(flow.render.done=!0,flow.render.pending.filter(function(pendingTask){return"function"==typeof pendingTask}).forEach(function(pendingTask){return pendingTask()}),flow.render.pending=[]),_this2.trigger("render"),_this2.trigger("ready")};return(options=Object.assign(options||{},newOptions),options.state||(options.state={}),!(elt instanceof HTMLElement)&&!(elt instanceof $))?this.trigger("error",new Error("A valid HTMLElement (or a jquery element) at least is required to render the item")):(options.state&&this.setState(options.state,!0),!1===flow.init.done?flow.init.pending.push(function(){return _this2.render(elt,options)}):(this.container=elt instanceof $?elt.get(0):elt,"function"==typeof provider.render?provider.render.call(this,this.container,renderDone,options):renderDone()),this)},clear:function clear(){var _this3=this,clearDone=function(){_this3.trigger("clear")};return"function"==typeof provider.clear?provider.clear.call(this,this.container,clearDone):clearDone(),this},getState:function getState(){return"function"==typeof provider.getState?provider.getState.call(this):null},setState:function setState(state){var _this4=this,isInitialStateRestore=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return!state||"object"!==_typeof(state)||Array.isArray(state)?this.trigger("error",new Error("The item's state must be a JavaScript Plain Object: ".concat(_typeof(state)," given"))):(!1===flow.render.done?flow.render.pending.push(function(){return _this4.setState(state,isInitialStateRestore)}):"function"==typeof provider.setState&&provider.setState.call(this,state,isInitialStateRestore),this)},getData:function getData(){return data},setData:function setData(itemData){return data=itemData,"function"==typeof provider.setData?provider.setData.call(this,itemData):Promise.resolve()},getResponses:function getResponses(){return"function"==typeof provider.getResponses?provider.getResponses.call(this):{}},renderFeedbacks:function renderFeedbacks(feedbacks,itemSession,done){"function"==typeof provider.renderFeedbacks&&provider.renderFeedbacks.call(this,feedbacks,itemSession,done)},suspend:function suspend(){return!suspended&&flow.render.done&&"function"==typeof provider.suspend?provider.suspend.call(this).then(function(result){return suspended=!0,result}):Promise.resolve()},close:function close(){return!closed&&flow.render.done&&"function"==typeof provider.close?provider.close.call(this).then(function(result){return closed=!0,result}):Promise.resolve()},resume:function resume(){return(suspended||closed)&&flow.render.done&&"function"==typeof provider.resume?provider.resume.call(this).then(function(result){return suspended=!1,closed=!1,result}):Promise.resolve()},isSuspended:function isSuspended(){return suspended},isClosed:function isClosed(){return closed}})};return itemRunnerFactory.register=function(name,provider){if("string"!=typeof name||0>=name.length)throw new TypeError("It is required to give a name to your provider.");if("object"!==_typeof(provider)||"function"!=typeof provider.init&&"function"!=typeof provider.render)throw new TypeError("A provider is an object that contains at least an init function or a render function.");this.providers=this.providers||{},this.providers[name]=provider},itemRunnerFactory}),define("taoItems/loader/taoItemsRunner.bundle",function(){});
//# sourceMappingURL=taoItemsRunner.min.js.map